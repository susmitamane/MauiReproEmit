on: [push]

jobs:
  iOS:
    runs-on: macos-13
    needs: GetVersion
    steps:
      - uses: actions/checkout@v4
      - name: Set Xcode version
        run: |
          XCODE_ROOT=/Applications/Xcode_15.2.app
          echo "MD_APPLE_SDK_ROOT=$XCODE_ROOT" >> $GITHUB_ENV       # set environment variable to specify Xcode for Mono and Xamarin
          sudo xcode-select -s $XCODE_ROOT
      - uses: actions/setup-dotnet@v4
        with:
          dotnet-version: '8.0.x'
      - name: Install .NET MAUI
        run: |
          dotnet workload install maui ios
      - name: Build
        run: |
          cd src/NewsReader/NewsReader.MauiSystem
          dotnet build -f net8.0-ios -c:Release /p:packageApp=false /p:buildForSimulator=true /p:ArchiveOnBuild=false -p:ApplicationVersion=${{ needs.GetVersion.outputs.version }} -p:ApplicationDisplayVersion=${{ needs.GetVersion.outputs.version }}
